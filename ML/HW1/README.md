# HW1

В задании была обучена модель регрессии для предсказания стоимости автомобилей


## Что сделано
- Произведен EDA
- Построены визуализации данных
- Произведена предварительная обработка данных
  - Удалены дубликаты строк. Полные и частичные (без таргет значения)
  - Удалены столбцы с непонятным типом значений (torque)
  - Числовые по смыслу столбцы приведены к реальному числовому виду, удалены единицы измерения
  - Пропуски заполнины медианами

Обучена модель *линейной регрессии с дефолтными параметрами* на числовых признаках
- Linear Regression Default : Train: MSE = 116873522067.38211 R2 = 0.5922613746055911
- Linear Regression Default : Test: MSE = 233298943864.99548 R2 = 0.5941416939423312
R2 примерно одинаковые для трейна и для теста, то есть нельзя говорить о явном переобучении. По MSE не понятно что можно сказать

Призаки стандартизированы при помощи *StandardScaler*
- Linear Regression Scaled : Train: MSE = 116873522067.38176 R2 = 0.5922613746055925
- Linear Regression Scaled : Test: MSE = 233298943864.98907 R2 = 0.5941416939423423
Значения метрик почти не изменилось

Оценили коэффициенты 
- *max_power* самый большой
- следующий по величине *год*
Выглядит логично. Более мощный двигатель в машинах более высокого класса, которые стоят дороже
Также год выпуска тоже логично - более новые машины дороже.


Использовали *Lasso* регуляризацию со стандартными настройками
- Lasso Default : Train: MSE = 116873522077.49564 R2 = 0.592261374570308
- Lasso Default : Test: MSE = 233299614653.79535 R2 = 0.5941405270051752
Зануления коэффициентов не произошло

Подобрали оптимальные параметры для Lasso при помощи кросс-валидации с 10 фолдами. При этом занулился параметр seats
Метрики стали хуже :)
- Lasso Best : Train: MSE = 117736025971.07419 R2 = 0.5892523427062533
- Lasso Best : Test: MSE = 240510972831.9918 R2 = 0.5815952939831536

Использовали *ElasticNet* регуляризацию
- ElasticNet Best : Train: MSE = 117201243294.93001 R2 = 0.5911180480379542
- ElasticNet Best : Test: MSE = 239624248813.7191 R2 = 0.5831378826551583

Добавили в рассмотрение *категориальные* признаки с OHE кодировкой
Использовали модель *Ridge*
- Ridge Best : Train: MSE = 96394823806.11533 R2 = 0.6637057542324987
- Ridge Best : Test: MSE = 224813828644.4829 R2 = 0.6089028173021274

## Результаты
В качестве бизнес метрики было предложено считать долю прогнозов, которые отличаются от реальной цены не больше чем на 10%
- Linear Regression Default 0.227
- Linear Regression Scaled 0.227
- Lasso Default 0.227
- Lasso Best 0.235
- Elastic 0.226
- Ridge 0.254

Наилучший результат получился для Ridge модели.
Возможно, потому что в ней участвовали еще и категориальные признаки


## Не сделано
- Не было анализа частичных дубликатов и логических дубликатов с немного разной записью слов. Напирмер, если name записано с разным количеством пробелов или в разном регистре.
- Не было анализа адекватности значений. Например, что цифры мощности (и других полей) не выше и не ниже определенных разумных значений. Только примерный визуальный анализ по графикам 
- Не использовался столбец name. Можно было бы из него извлечь информацию о марке и моделе автомобиля  
